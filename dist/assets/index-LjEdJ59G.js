import{P as i,r as x,R as k,u as Q,j as t,w as K,G as b,L as H,g as w,N as U,o as M,O as C,i as B,k as G,Q as A,U as V,S as W,a as z,V as P,B as h,l as v,E as I,h as L,W as tt,X as et,v as $,Y as at,Z as nt,_ as st,$ as it}from"./index-CMhOF5Py.js";import{u as J,p as rt,a as ot}from"./APIHooks-DItCotpK.js";import{U as lt,P as ct,J as ut}from"./jodit-react-DjkgfNEC.js";import"./lodash-CW1nyizk.js";const dt=[{id:1,name:"Wheel"},{id:2,name:"Towing"},{id:3,name:"Safety"}],X=({isEdit:e,inStock:d,productInfo:n,productSpec:r,setProductSpec:o,setFieldValue:s,setProductInfo:p,selectedTags:E,setSelectedTags:F})=>{const[g,D]=x.useState(0),[l]=[],S=k.useRef(null),T=Q(),[{apiData:j,loading:m},{setQueryParams:O}]=J("/brand",[],{},!1),{results:N}=j||{},[{apiData:Z,loading:xt},{setQueryParams:q}]=J("/Category",[],{},!1),{results:R}=Z||{};return x.useEffect(()=>{O({page:g,filterData:l}),q({page:g,filterData:l})},[g,l]),x.useEffect(()=>{},[g,l]),t.jsx(K,{direction:"left",in:!0,mountOnEnter:!0,unmountOnExit:!0,children:t.jsxs(b,{item:!0,xs:12,lg:4,children:[t.jsxs(H,{style:{height:"700px"},children:[t.jsxs(w,{title:"Product Details",children:[t.jsx(U,{control:t.jsx(M,{checked:d,onChange:a=>s("inStock",a.target.checked),name:"inStock"}),label:"In Stock"}),t.jsx(C,{name:"SKU",variant:"outlined",sx:{width:"100%",my:4},label:"Product SKU"}),t.jsxs(B,{sx:{width:"100%"},variant:"outlined",children:[t.jsx(G,{ref:S,id:"demo-simple-select-outlined-label",children:t.jsx(A,{id:"common.brand"})}),t.jsx(V,{name:"brand",label:t.jsx(A,{id:"common.brand"}),labelId:"label-select-outlined-label",as:W,onChange:a=>s("brand",a.target.value),children:N&&N.map(a=>t.jsx(z,{value:a.id,sx:{cursor:"pointer",inputVariant:"outlined"},children:a.name},a.id))})]}),t.jsxs(B,{sx:{width:"100%",my:4},variant:"outlined",children:[t.jsx(G,{ref:S,children:t.jsx(A,{id:"common.category"})}),t.jsx(V,{name:"category",label:t.jsx(A,{id:"common.category"}),as:W,onChange:a=>s("category",a.target.value),children:R&&R.map(a=>t.jsx(z,{value:a.id,sx:{cursor:"pointer",inputVariant:"outlined"},children:a.name},a.id))})]}),t.jsx(P,{multiple:!0,id:"tags-outlined",sx:{width:"100%",my:4},options:dt,autoHighlight:!0,getOptionLabel:a=>a.name,value:E,onChange:(a,c)=>F(c),renderOption:(a,c)=>t.jsx(h,{component:"li",sx:{display:"flex",alignItems:"center"},...a,children:t.jsx(h,{ml:4,children:c==null?void 0:c.name})}),filterSelectedOptions:!0,renderInput:a=>t.jsx(v,{...a,variant:"outlined",label:"Tags",fullWidth:!0})})]}),t.jsxs(w,{title:"Product Pricing",sxStyle:{mt:7},children:[t.jsx(C,{name:"mrp",type:"number",variant:"outlined",sx:{width:"100%",my:2,"& .MuiInputBase-input":{pl:2}},InputProps:{startAdornment:"$"},label:"Regular Price"}),t.jsx(C,{name:"salemrp",type:"number",variant:"outlined",sx:{width:"100%",my:2,"& .MuiInputBase-input":{pl:2}},InputProps:{startAdornment:"$"},label:"Sale Price"}),t.jsx(U,{control:t.jsx(M,{value:"checkedA",inputProps:{"aria-label":"secondary checkbox"},name:"inStock"}),label:"Tax Inclusive"}),t.jsx(C,{type:"number",name:"discount",variant:"outlined",sx:{width:"100%",my:2},label:"Discount %"})]}),t.jsx(w,{title:"Product Specification",sxStyle:{mt:7},action:t.jsx(I,{variant:"contained",color:"primary",onClick:()=>{o([...r,{id:r.length+1,title:"",desc:""}])},children:"Add New"}),children:t.jsx(L,{spacing:4,children:r.map((a,c)=>t.jsxs(k.Fragment,{children:[t.jsx(b,{item:!0,xs:12,sm:6,children:t.jsx(v,{variant:"outlined",value:a.title,sx:{width:"100%",my:2},onChange:f=>{const{value:y}=f.target,u=[...r];u[c].title=y,p(u)},label:"Product Label"})}),t.jsx(b,{item:!0,xs:12,sm:6,children:t.jsx(v,{variant:"outlined",value:a.desc,sx:{width:"100%",my:2},onChange:f=>{const{value:y}=f.target,u=[...r];u[c].desc=y,p(u)},label:"Product Value"})})]},c))})}),t.jsx(w,{title:"Product Details",sxStyle:{mt:7},action:t.jsx(I,{variant:"contained",color:"primary",onClick:()=>{p([...n,{id:n.length+1,title:"",desc:""}])},children:"Add New"}),children:t.jsx(L,{spacing:4,children:n.map((a,c)=>t.jsxs(k.Fragment,{children:[t.jsx(b,{item:!0,xs:12,sm:6,children:t.jsx(v,{variant:"outlined",value:a.title,sx:{width:"100%",my:2},onChange:f=>{const{value:y}=f.target,u=[...n];u[c].title=y,p(u)},label:"Product Label"})}),t.jsx(b,{item:!0,xs:12,sm:6,children:t.jsx(v,{variant:"outlined",value:a.desc,sx:{width:"100%",my:2},onChange:f=>{const{value:y}=f.target,u=[...n];u[c].desc=y,p(u)},label:"Product Value"})})]},c))})})]}),t.jsxs(tt,{spacing:3,direction:"row",sx:{justifyContent:"flex-end",mt:4},children:[t.jsx(I,{sx:{minWidth:100,color:"text.secondary"},variant:"text",onClick:()=>T(-1),children:"Cancel"}),t.jsxs(I,{sx:{display:"block",minWidth:100},color:"primary",variant:"contained",type:"submit",children:[e?"Edit":"Add"," Product"]})]})]})})};X.propTypes={isEdit:i.bool,inStock:i.bool,productInfo:i.array,productSpec:i.array,setProductSpec:i.func,setFieldValue:i.func,setProductInfo:i.func,selectedTags:i.array,setSelectedTags:i.func};const _=({uploadedFiles:e,setUploadedFiles:d})=>{const n=et({accept:{"image/png":[".png",".jpeg",".jpg"]},onDrop:o=>{d(o.map(s=>Object.assign(s,{preview:URL.createObjectURL(s)})))}});x.useEffect(()=>{d(n.acceptedFiles)},[n.acceptedFiles]);const r=o=>{n.acceptedFiles.splice(n.acceptedFiles.indexOf(o),1),d([...n.acceptedFiles])};return t.jsxs("section",{className:"container",style:{cursor:"pointer"},children:[t.jsx(lt,{setUploadedFiles:d,dropzone:n,customContent:t.jsxs(t.Fragment,{children:[t.jsx("img",{src:"/assets/icon/upload.svg",width:40,height:40,alt:"upload"}),t.jsxs("p",{children:[t.jsx(h,{component:"span",sx:{color:"primary.main",fontWeight:$.MEDIUM},children:"Click to upload"})," ","or drag and drop"]}),t.jsx(h,{component:"p",sx:{mt:1},children:"SVG, PNG, JPG or GIF (max. 800x400px)"})]})}),t.jsx(at,{sx:{maxWidth:500},data:e,column:4,itemPadding:5,renderRow:(o,s)=>t.jsx(ct,{file:o,onDeleteUploadFile:r},s+o.path)})]})};_.propTypes={uploadedFiles:i.array,setUploadedFiles:i.func};const pt={readonly:!1,toolbar:!0,minHeight:300,maxHeight:500,buttons:["source","|","bold","strikethrough","underline","italic","|","ul","ol","|","outdent","indent","|","font","fontsize","paragraph","|","image","video","table","link","|","align","undo","redo","selectall","cut","copy","|","hr","|","about"],uploader:{insertImageAsBase64URI:!0,url:"/api/upload",format:"json",imagesExtensions:["jpg","png","jpeg","gif"],headers:{"X-CSRF-TOKEN":"CSFR-Token",Authorization:"Bearer <JSON Web Token>"},getMessage:function(e){return e.msg},process:function(e){return{files:e.data}}},style:{"& .jodit .jodit-status-bar":{background:"#29572E",color:"rgba(255,255,255,0.5)"}}},Y=({content:e,uploadedFiles:d,setUploadedFiles:n,setFieldValue:r})=>{const o=x.useRef(null);return t.jsx(K,{direction:"right",in:!0,mountOnEnter:!0,unmountOnExit:!0,children:t.jsx(b,{item:!0,xs:12,lg:8,children:t.jsx(H,{style:{height:"700px"},children:t.jsxs(w,{children:[t.jsx(C,{name:"title",variant:"outlined",sx:{width:"100%",my:2},label:"Product Name"}),t.jsx(h,{component:"p",sx:{mt:3,fontSize:16},children:"Description*"}),t.jsx(h,{sx:{width:"100%",my:2},children:t.jsx(ut,{ref:o,value:e,placeholder:"Description here",config:pt,tabIndex:1,onChange:s=>r("description",s)})}),t.jsx(h,{component:"p",sx:{mt:3,mb:2,fontSize:16},children:"Images"}),t.jsx(_,{uploadedFiles:d,setUploadedFiles:n})]})})})})};Y.propTypes={content:i.string,uploadedFiles:i.array,setUploadedFiles:i.func,setFieldValue:i.func,selectedTags:i.array};const mt=({selectedProd:e})=>{const[d,n]=x.useState([]),[r,o]=x.useState([]),s=nt(),p=Q(),[E,F]=k.useState([{id:1,title:"",desc:""}]),[g,D]=k.useState([{id:1,title:"",desc:""}]);return x.useEffect(()=>{e&&(n((e==null?void 0:e.tag)||[]),o(e==null?void 0:e.image.map(l=>({...l,preview:l.src}))),F(e==null?void 0:e.productInfo),D(e==null?void 0:e.productSpec))},[e]),t.jsxs(t.Fragment,{children:[t.jsx(h,{component:"h2",variant:"h2",sx:{fontSize:16,color:"text.primary",fontWeight:$.SEMI_BOLD,mb:{xs:2,lg:4}},children:e?"Edit Product":"Create a new product"}),t.jsx(st,{validateOnChange:!0,initialValues:e?{...e,category:(e==null?void 0:e.category)||1}:{title:"",SKU:"",category:1,mrp:0,salemrp:0,discount:0,inStock:!1},onSubmit:(l,{setSubmitting:S,resetForm:T})=>{S(!0);const j=new FormData;j.append("product",JSON.stringify(l)),j.append("productInfo",JSON.stringify(E)),j.append("productSpec",JSON.stringify(g));for(let m=0;m<r.length;m++)j.append("images[]",r[m]);if(e){const m={...e,...l};rt("/api/ecommerce/list/update",s,{product:m}).then(()=>{p("/ecommerce/product-listing"),s.showMessage("Product updated successfully!")}).catch(O=>{s.fetchError(O.message)})}else ot("/product",s,j).then(()=>{s.showMessage("Product created successfully!"),p("/ecommerce/product-listing")}).catch(m=>{s.fetchError(m.message)});S(!1),T()},children:({setFieldValue:l})=>t.jsx(it,{noValidate:!0,autoComplete:"off",children:t.jsxs(L,{children:[t.jsx(Y,{content:(e==null?void 0:e.description)||"",uploadedFiles:r,setUploadedFiles:o,setFieldValue:l}),t.jsx(X,{isEdit:!!e,inStock:e==null?void 0:e.inStock,selectedTags:d,productInfo:E,productSpec:g,setProductInfo:F,setFieldValue:l,setSelectedTags:n,setProductSpec:D})]})})})]})};mt.propTypes={selectedProd:i.object};export{mt as AddEditProduct,mt as default};
